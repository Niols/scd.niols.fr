{%- macro error(message) -%}
    {{ message|error }}
{%- endmacro -%}

{%- macro shortAuthorOrAuthor(tune) -%}
    {%- if tune['short-author'] is defined -%}
        {{ tune['short-author'] }}
    {%- else -%}
        {{ tune.author }}
    {%- endif -%}
{%- endmacro -%}

{%- macro fancyDate(tune) -%}
    {%- if tune['date-format'] is defined -%}
        {{ tune.date|fancyDate(tune['date-format']) }}
    {%- else -%}
        {{ tune.date|fancyDate }}
    {%- endif -%}
{%- endmacro -%}

{%- macro danceRow(slug, dance, global=false) -%}
    <tr>
        <td>{# no space -#}
            <a href="dance/{{ slug }}.html">{# no space -#}
                {{ dance.name }}{# no space -#}
            </a>{# no space -#}
        </td>
        {%- if global -%}
            <td>Dance</td>
        {%- endif -%}
        <td>{{ dance['short-kind'] }}</td>
        <td>{{ shortAuthorOrAuthor(dance) }}</td>
    </tr>
{%- endmacro -%}

{%- macro tuneRow(slug, tune, global=false) -%}
    <tr>
        <td>{# no space -#}
            <a href="tune/{{ slug }}.html">{# no space -#}
                {{ tune.name }}{# no space -#}
            </a>{# no space -#}
        </td>
        {%- if global -%}
            <td>Tune</td>
        {%- endif -%}
        <td>{{ tune['short-kind'] }}</td>
        <td>{{ shortAuthorOrAuthor(tune) }}</td>
    </tr>
{%- endmacro -%}

{%- macro bookRow(slug, book, global=false) -%}
    <tr>
        <td>{# no space -#}
            <a href="book/{{ slug }}.html">{# no space -#}
                {{ book.title }}{# no space -#}
            </a>{# no space -#}
        </td>
        {%- if global -%}
            <td>Book</td>
            <td></td>
            <td></td>
        {%- endif %}
    </tr>
{%- endmacro -%}

{%- macro welcomeMessage() -%}
    <p>
        Welcome! I am Nicolas “Niols” Jeannerod; you are here on my
        domain. This website aims at gathering clean descriptions of
        Scottish country dances and tunes that would not be made easily
        available otherwise. I give them a stable, nice, warm home. In
        particular, it will contain all of my unpublished work. Feel free
        to <a href="mailto:niols+scd@niols.fr">send me</a> your dances
        and tunes, if you want them “published”.
    </p>
    <p>
        The goal is <em>not</em> to provide a new database. For this, the
        <a href="https://my.strathspey.org/dd/index/">Scottish Country
            Dance Database</a> does the job amazingly well. Therefore, this
        website will probably remain with very limited indexing
        capabilities. However, it might very well serve as source of
        dance descriptions for the SCDDB.
    </p>
    <p>
        Note that the sources of this website are available
        <a href="https://github.com/Niols/scd.niols.fr">on GitHub</a>
        and backed up on the
        <a href="https://archive.softwareheritage.org/browse/origin/?origin_url=https://github.com/Niols/scd.niols.fr">
            Software Heritage archive</a>. The content of the website itself
        is backed up on the
        <a href="https://web.archive.org/web/*/https://scd.niols.fr/">
            Wayback Machine</a>. This makes this website <em>very</em> public
        and <em>very</em> stable. (Which, in my opinion, are great
        things, but heh.)
    </p>
{%- endmacro -%}
